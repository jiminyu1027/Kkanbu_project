<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<mapper namespace="edu.study.mapper.CartMapper">
		<!-- 카트 목록 -->
  	<select id="list" resultType="CartVO" parameterType="int">
   		 SELECT ctidx,  
  		 	p.pidx,  
   		 	m.midx, 
   		 	c.mId,  
  		 	amount, 
   		 	m.mName,  
   		 	p.pPrice,  
  		 	p.pBrandeng, 
   		 	p.pNamekr, 
   		 	p.pColor, 
  		 	p.pSize,
  		 	p.pFile1 
   		 	FROM cart c, product p, member m 
  		 	WHERE m.mId=c.mId AND c.pidx=p.pidx AND c.midx=#{midx}
	 	ORDER BY ctidx 
  	</select> 
  
	<!-- 합계 -->
	<select id="sum" resultType="int">
		SELECT SUM(pPrice) 
		FROM cart c, product p
		WHERE c.pidx = p.pidx AND c.midx=#{c.midx}
	</select>

	<!-- 총합 -->
	<select id="sumMoney" resultType="int">
		SELECT NVL(SUM(p.pPrice*amount),0) money
		FROM cart c, product p
		WHERE c.pidx = p.pidx AND c.midx=#{c.midx}
	</select>
	
	<!-- 상품개별삭제 -->
	<delete id="del">
		DELETE FROM cart WHERE ctidx=#{ctidx}
	</delete>
  	
</mapper>